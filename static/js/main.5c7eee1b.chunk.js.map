{"version":3,"sources":["decoders/base64.js","decoders/common.js","decoders/jwt.js","decoders/skypeToken.js","decoders/regToken.js","decoders/syncState.js","App.js","decoders/index.js","index.js"],"names":["cracker","token","key","atob","_ignore","crackJWT","parts","split","length","header","JSON","parse","payload","signature","readInt","byteArray","byte","signed","result","long","UZERO","shift","pos","add","fromInt","shiftLeft","toSigned","slice","readBytes","io","len","strBytes","readString","Math","pow","readUint","String","fromCharCode","utf8","decode","readByteFragment","bytes","string","crackedToken","json","SkypeTokenScopes","dateFromEpochSeconds","seconds","betterBeInTheFuture","date","Date","test","v","_","lte","now","gt","valueOf","className","toISOString","replace","trim","every","at","Boolean","kid","iat","exp","csi","bitmask","scp","scopes","join","compact","map","k","skypeid","tid","rgn","deserializeAuthContext","authType","name","hasPp","pp","as","bd","bdp","cid","country","dfu","fname","fla","gen","isid","lp","lri","mname","pcode","puidh","puidl","rep","wal","readPp","numIds","identifiers","rui","i","identifier","push","isrea","hassky","skyid","uictsn","hastid","csid","numScp","rscp","scope","cloneDeepWith","item","isLong","toString","undefined","decoded","entries","term","value","base64","toByteArray","e","isObject","state","match","chunk","grp","Number","parseInt","i$ver","sta","toNumber","ntwrk","c$flt","skypeId","ver","dSeg","range","numSegments","start","end","flatten","seg","some","d","isNaN","getTime","lcVer","lcID","thID","App","props","textAreaState","ref","input","style","minHeight","max","scrollHeight","resizeTA","placeholder","onChange","handleChange","this","autoFocus","target","tests","over","skypeToken","jwt","regToken","syncState","isArray","first","getDefaultResult","setState","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.5c7eee1b.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport function cracker(token) {\r\n    try {\r\n        return token ? <div key=\"base64-result\">\r\n            <aside>Base64</aside>\r\n            <span>{atob(token)}</span></div> : null;\r\n    }\r\n    catch (_ignore) {\r\n        return null;\r\n    }\r\n}\r\n","import long from 'long';\r\nimport utf8 from 'utf8';\r\n\r\nexport function crackJWT(token) {\r\n    let parts = token.split(\".\");\r\n    if (parts.length !== 3) {\r\n        return null;\r\n    }\r\n\r\n    let header = JSON.parse(atob(parts[0])), payload = JSON.parse(atob(parts[1])), signature = parts[2];\r\n    return {header, payload, signature};\r\n}\r\n\r\nexport function readUint(byteArray) {\r\n    let result = 0;\r\n    let shift = 0;\r\n    let pos = 0;\r\n    while(true) {\r\n        let byte = byteArray[pos++];\r\n\r\n        result += (byte & 0x7f) * Math.pow(2, shift);\r\n        if ((byte & 0x80) === 0) {\r\n            break;\r\n        }\r\n        shift += 7;\r\n    }\r\n    return [byteArray.slice(pos), result];\r\n}\r\n\r\nexport function readInt(byteArray, length=4, signed=true) {\r\n    let result = long.UZERO;\r\n    let shift = 0;\r\n    let pos = 0;\r\n    let byte;\r\n\r\n    while(length) {\r\n        byte = byteArray[pos++];\r\n\r\n        result = result.add( long.fromInt(byte & 0xff).shiftLeft(shift) );\r\n        shift += 8;\r\n        length--;\r\n    }\r\n    if (signed && (byte & 0x80)) {\r\n        result = result.toSigned();\r\n    }\r\n    return [byteArray.slice(pos), result];\r\n}\r\n\r\nexport function readBytes(io, len) {\r\n    let strBytes = [...io.slice(0, len)];\r\n    return [io.slice(len), strBytes];\r\n}\r\n\r\nexport function readString(io) {\r\n    let len;\r\n    [io, len] = readUint(io);\r\n    let strBytes = String.fromCharCode(...io.slice(0, len));\r\n    return [io.slice(len), utf8.decode(strBytes)];\r\n}\r\n\r\nexport function readByteFragment(io) {\r\n    let len, bytes;\r\n    [io, len] = readInt(io);\r\n    [io, bytes]= readBytes(io, len);\r\n    bytes.string = ()=> utf8.decode(String.fromCharCode(...bytes));\r\n    return [io, bytes];\r\n}\r\n","import React from 'react';\r\nimport JSONPretty from 'react-json-pretty';\r\n\r\nimport {crackJWT} from './common.js';\r\n\r\nexport function cracker(token) {\r\n    try {\r\n        let crackedToken = crackJWT(token);\r\n        return crackedToken && <div key=\"JWT-result\">\r\n                <aside>JWT</aside>\r\n                <table>\r\n                    <tbody>\r\n                    <tr>\r\n                        <td>header</td>\r\n                        <td><JSONPretty json={crackedToken.header}></JSONPretty></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>payload</td>\r\n                        <td><JSONPretty json={crackedToken.payload}></JSONPretty>}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>signature</td>\r\n                        <td>{crackedToken.signature}</td>\r\n                    </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>;\r\n    }\r\n    catch (_ignore) {\r\n        return null;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport _ from 'lodash';\r\n\r\nimport {crackJWT} from './common.js';\r\n\r\nconst SkypeTokenScopes = [\r\n    [1, \"refresh\"],\r\n    [2, \"uic\"],\r\n    [4, \"identity\"],\r\n    [8, \"identity_update\"],\r\n    [16, \"contacts\"],\r\n    [32, \"contacts_update\"],\r\n    [64, \"reauth\"],\r\n    [128, \"commerce\"],\r\n    [256, \"communication\"],\r\n    [512, \"communication_ro\"],\r\n    [956, \"client\"]\r\n];\r\n\r\nfunction getFlagNames(bitmask, scopes) {\r\n    return _.join(_.compact(scopes.map(([k,v]) => (bitmask & k) === k ? v : null)), \", \")\r\n}\r\n\r\nfunction dateFromEpochSeconds(seconds, betterBeInTheFuture = false) {\r\n    let date = new Date(seconds * 1000);\r\n    let test = betterBeInTheFuture ?\r\n        v=>_.lte(v, Date.now()) :\r\n        v=>_.gt(v, Date.now());\r\n    return test(date.valueOf()) ?\r\n        <span className=\"date_future\">{date.toISOString()}</span> :\r\n        <span>{date.toISOString()}</span>;\r\n}\r\n\r\n/*\r\n Authentication:skypetoken=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjIifQ.eyJpYXQiOjE0NzcxNzYwMjcsImV4cCI6MTQ3NzI2MjQyNywic2t5cGVpZCI6ImVtaWwubWllaWxpY2EiLCJzY3AiOjk1OCwiY3NpIjoiOCIsImNpZCI6ImFiZWNkMWIzNTIyY2I1ZjgiLCJhYXQiOjE0NzcwMDc2NjR9.ck4dDkv9nqwj1-rGRh9CGxduMBYgAv0iA3ebPNefgDsWaqnQGgiTjrPatppN7I8P3-mRhiA3qphaai1C4ZiuM-5oByWGC7NvKWeD-vIikqQ_GlsMEtqXEd6kUXSZTnFE3AlZuwW7JeqTZSr8DibKpj2OMriWCEYueZvZ3nCXxH972U5f6PZCln_Uz3IlKASX8Iiw6RZ1c3-5Gzlk\r\n */\r\nexport function cracker(token) {\r\n    try {\r\n        token = token\r\n            .replace(/^(Authentication:\\s*)?skypetoken=/i,\"\")\r\n            .trim();\r\n\r\n        let crackedToken = crackJWT(token);\r\n\r\n        if (!crackedToken || !_.every(_.at(crackedToken, \"header.kid\", \"payload.skypeid\", \"payload.scp\"), Boolean)) {\r\n            return null;\r\n        }\r\n\r\n        return <div key=\"SkypeToken-result\">\r\n            <aside>SkypeToken</aside>\r\n            <table>\r\n                <tbody>\r\n                <tr>\r\n                    <td>Key ID</td>\r\n                    <td>{crackedToken.header.kid}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Issued time</td>\r\n                    <td>{dateFromEpochSeconds(crackedToken.payload.iat)}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Expires</td>\r\n                    <td>{dateFromEpochSeconds(crackedToken.payload.exp)}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Serial</td>\r\n                    <td>{crackedToken.payload.csi}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Scopes</td>\r\n                    <td>{`${getFlagNames(crackedToken.payload.scp, SkypeTokenScopes)} (${crackedToken.payload.scp})`}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>SkypeID</td>\r\n                    <td>{crackedToken.payload.skypeid}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Tenat</td>\r\n                    <td>{crackedToken.payload.tid}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Region</td>\r\n                    <td>{crackedToken.payload.rgn}</td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>;\r\n    }\r\n    catch (_ignore) {\r\n        return null;\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport {readString, readInt, readBytes} from './common.js';\r\nimport base64 from 'base64-js';\r\nimport long from 'long';\r\n\r\nimport React from 'react';\r\nimport JSONPretty from 'react-json-pretty';\r\n\r\nfunction readPp(io) {\r\n    let pos, result={};\r\n    pos = io;\r\n\r\n    result.as = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.bd = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.bdp = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.cid = function(){ let result; [pos, result] = readInt(pos, 8); return result; }();\r\n    result.country = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.dfu = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n    result.fname = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.fla = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n    result.gen = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.isid = function(){ let result; [pos, result] = readInt(pos, 4, false); return result; }();\r\n    result.lp = function(){ let result; [pos, result] = readInt(pos, 2); return result; }();\r\n    result.lri = function(){ let result; [pos, result] = readInt(pos, 8); return result; }();\r\n    result.mname = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.pcode = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.puidh = function(){ let result; [pos, result] = readInt(pos, 4, true); return result; }();\r\n    result.puidl = function(){ let result; [pos, result] = readInt(pos, 4, true); return result; }();\r\n    result.rep = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    result.wal = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n\r\n    return [pos, result];\r\n}\r\n\r\nfunction deserializeAuthContext(byteArray) {\r\n    let pos;\r\n    pos = byteArray;\r\n\r\n    const authType = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    const name = function(){ let result; [pos, result] = readString(pos); return result; }();\r\n    const hasPp = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n\r\n    const pp = function(){\r\n        let result;\r\n        if (hasPp !== 0) {\r\n            [pos, result] = readPp(pos);\r\n        }\r\n        return result;\r\n    }();\r\n\r\n    const numIds = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n    const identifiers = [];\r\n    let rui = function(){ let result; [pos, result] = readInt(pos, 8); return result; };\r\n\r\n    for(let i=0; i< numIds; i++) {\r\n        let identifier = rui();\r\n        identifiers.push(identifier);\r\n    }\r\n\r\n    const isrea = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n    const hassky = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n\r\n    const skyid = function(){\r\n        let result;\r\n        if (hassky !== 0) {\r\n            [pos, result] = readString(pos);\r\n        }\r\n        return result;\r\n    }();\r\n\r\n    const uictsn = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n\r\n    const hastid = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n    const tid = function(){\r\n        let result;\r\n        if (hastid !== 0) {\r\n            [pos, result] = readBytes(pos, 16);\r\n        }\r\n        return result;\r\n    }();\r\n\r\n    const csid = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n\r\n    const numScp = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n    const scp = [];\r\n    let rscp = function(){ let result; [pos, result] = readString(pos); return result; };\r\n\r\n    for(let i=0; i< numScp; i++) {\r\n        let scope = rscp();\r\n        scp.push(scope);\r\n    }\r\n\r\n    return _.cloneDeepWith({authType, name, hasPp, pp, numIds, identifiers, isrea, hassky, skyid, uictsn, hastid, tid, csid, numScp, scp},\r\n        item=> long.isLong(item) ? item.toString() : undefined);\r\n}\r\n\r\n/*\r\n Set-RegistrationToken:registrationToken=U2lnbmF0dXJlOjI6Mjg6QVFRQUFBREloK3BpYlMyaGd0VDN6R21sT2lvdTtWZXJzaW9uOjY6MToxO0lzc3VlVGltZTo0OjE5OjUyNDc4MTM3NTU0MTEwMDIzMjM7RXAuSWRUeXBlOjc6MToxO0VwLklkOjI6MjU6ZW1pbC5taWVpbGljYUBvdXRsb29rLmNvbTtFcC5FcGlkOjU6MzY6NGVlYjQ4MzAtZDM3Yy00M2I0LTg5ZTQtMTY1NzBjOTI3NjNlO0VwLkxvZ2luVGltZTo3OjE6MDtFcC5BdXRoVGltZTo0OjE5OjUyNDc4MTM3NTU0MDg2NTg1NTI7RXAuQXV0aFR5cGU6NzoyOjE1O0VwLkV4cFRpbWU6NDoxODo2MzYxMjg1OTIyNzAwMDAwMDA7VXNyLk5ldE1hc2s6MTE6MTozO1Vzci5YZnJDbnQ6NjoxOjE7VXNyLlJkcmN0RmxnOjI6MTA6R2VvSG9zdGluZztVc3IuRXhwSWQ6OToxOjA7VXNyLkV4cElkTGFzdExvZzo0OjE6MDtVc2VyLkF0aEN0eHQ6MjoyNzY6Q2xOcmVYQmxWRzlyWlc0WlpXMXBiQzV0YVdWcGJHbGpZVUJ2ZFhSc2IyOXJMbU52YlFFRFZXbGpGREV2TVM4d01EQXhJREV5T2pBd09qQXdJRUZOREU1dmRGTndaV05wWm1sbFpQaTFMRkt6MGV5ckFBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUExbGJXbHNMbTFwWldsc2FXTmhBQUFBQUFBQUFBQUFCMDV2VTJOdmNtVUFBQUFBQkFBQUFBQUFBQUFBQUFBQStMVXNVclBSN0tzQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFFTlpXMXBiQzV0YVdWcGJHbGpZUUFBQUFBQUFBQUFBQT09Ow==; expires=1477263298; endpointId={4eeb4830-d37c-43b4-89e4-16570c92763e}\r\n */\r\nexport function cracker(token) {\r\n    try {\r\n        token = token\r\n            .replace(/^((Set-)?RegistrationToken:\\s*)?registrationToken=/i,\"\")\r\n            .trim()\r\n            .split(\";\")[0];\r\n\r\n        if (!token) {\r\n            return;\r\n        }\r\n\r\n        let decoded = atob(token);\r\n\r\n        let entries = _.compact(decoded.split(\";\"))\r\n            .map(term=>{\r\n                let [key, , ,value] = term.split(\":\");\r\n                return {key, value};\r\n            })\r\n            .map( ({key,value})=> key===\"User.AthCtxt\" ? {key, value: deserializeAuthContext(base64.toByteArray(value))} : {key, value} );\r\n\r\n        if (entries.length === 1) {\r\n            return;\r\n        }\r\n\r\n        return <div key=\"RegToken-result\">\r\n            <aside>RegToken</aside>\r\n            <table>\r\n                <tbody>\r\n                { entries.map(e=><tr key={e.key}><td>{e.key}</td><td>{ _.isObject(e.value) ? <JSONPretty json={e.value}></JSONPretty> : e.value }</td></tr>)}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    }\r\n    catch (_ignore) {\r\n        return null;\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport {readInt, readByteFragment} from './common.js';\r\nimport long from 'long';\r\n\r\nimport React from 'react';\r\nimport JSONPretty from 'react-json-pretty';\r\n\r\n/*\r\n syncState=1a8a39e0d9570100000000000057000000f8b52c52b3d1ecab0d000000656d696c2e6d6965696c696361fd04098c430100000100000000000000000b21412c58010000018a39e0d9570100000b21412c580100000100000000000000000b21412c58010000018a39e0d9570100000b21412c5801000001e00a3807580100000b21412c58010000000000000000000000000000&\r\n */\r\nexport function cracker(state) {\r\n    try {\r\n        state = (state.match(/[0-9a-fA-F]{4,}/) || [])[0];\r\n        if (!state || state.length%2) {\r\n            return null;\r\n        }\r\n\r\n        let bytes = _.chunk(state, 2)\r\n            .map(grp=>grp.join(''))\r\n            .map(byte=>Number.parseInt(byte, 16));\r\n\r\n        let pos;\r\n        pos = bytes;\r\n\r\n        const i$ver = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n        const sta = function(){ let result; [pos, result] = readInt(pos, 8); return new Date(result.toNumber()); }();\r\n\r\n        const ntwrk = function(){ let result; [pos, result] = readByteFragment(pos); return result.string(); }();\r\n        const c$flt = function(){ let result; [pos, result] = readInt(pos); return result; }();\r\n        const cid = function(){ let result; [pos, result] = readInt(pos, 8); return result; }();\r\n        const skypeId = function(){ let result; [pos, result] = readByteFragment(pos); return result.string(); }();\r\n        const ver = function(){ let result; [pos, result] = readInt(pos, 8); return result; }();\r\n        const dSeg = _.range(i$ver>=25 ? 5 : 4).map(()=> {\r\n            const numSegments = function(){ let result; [pos, result] = readInt(pos, 1); return result; }();\r\n            return _.range(numSegments).map( ()=> {\r\n                return {\r\n                    start: function(){ let result; [pos, result] = readInt(pos, 8); return new Date(result.toNumber()); }(),\r\n                    end: function(){ let result; [pos, result] = readInt(pos, 8); return new Date(result.toNumber()); }()\r\n                };\r\n            })\r\n        });\r\n\r\n        if (!skypeId ||\r\n            [sta, ..._.flatten(_.flatten(dSeg).map( seg=> [seg.start, seg.end]))].some( d=> isNaN(d.getTime()))\r\n        ) {\r\n            return null;\r\n        }\r\n\r\n        const lcVer = function(){ let result; [pos, result] = readInt(pos, 8); return result; }();\r\n        const lcID = (lcVer > 0) && function(){ let result; [pos, result] = readByteFragment(pos); return result.string(); }();\r\n        const thID = (i$ver>=25) && function(){ let result; [pos, result] = readByteFragment(pos); return result.string(); }();\r\n\r\n        const result = _.cloneDeepWith({i$ver, sta, ntwrk, c$flt, cid, skypeId, ver, dSeg, lcVer, lcID, thID}, item=> long.isLong(item) ? item.toString() : undefined );\r\n        return <div key=\"SyncState-result\">\r\n            <aside>SyncState</aside>\r\n            <div><JSONPretty json={result}></JSONPretty></div>\r\n        </div>;\r\n    }\r\n    catch (_ignore) {\r\n        return null;\r\n    }\r\n}\r\n","import React, {Component} from 'react';\r\nimport './App.css';\r\nimport _ from 'lodash';\r\nimport {cracker} from './decoders/index.js';\r\n\r\nfunction getDefaultResult(token) {\r\n    return token ? <div key=\"default-result\"><span>Don't know</span></div> : \"\";\r\n}\r\n\r\nclass App extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {token: ''};\r\n    }\r\n\r\n    render() {\r\n        let textAreaState= {};\r\n        let resizeTA = function (input) {\r\n            input.style.minHeight = 'auto';\r\n            input.style.minHeight = Math.max(input.scrollHeight, 70) + 'px';\r\n        };\r\n\r\n        return (\r\n            <div className=\"App\">\r\n                <div className=\"App-header\">\r\n                    <h2>Crack a token!</h2>\r\n                </div>\r\n                <main className=\"App-intro\">\r\n                    <textarea\r\n                        ref={input=> input? textAreaState.input=input : textAreaState.input && resizeTA(textAreaState.input) }\r\n                        className=\"the-token\"\r\n                        placeholder=\"Enter the encoded mambo jumbo\"\r\n                        onChange={e => this.handleChange(e)}\r\n                        value={this.state.token}\r\n                        autoFocus={true}\r\n                    />\r\n                    <div className=\"the-result\">\r\n                        {this.state.result || \"\"}\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    handleChange(e) {\r\n        let token = (e.target.value || \"\").trim();\r\n        let state = {token, result: null};\r\n\r\n        let result = cracker(token);\r\n        if (_.isArray(result)) {\r\n            result = _.first(result);\r\n        }\r\n        state.result = result || getDefaultResult(token);\r\n\r\n        this.setState(state);\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport _ from 'lodash';\r\n\r\nimport * as base64 from './base64.js';\r\nimport * as jwt from './jwt.js';\r\nimport * as skypeToken from './skypeToken.js';\r\nimport * as regToken from './regToken.js';\r\nimport * as syncState from './syncState.js';\r\n\r\nexport function cracker(token) {\r\n    let tests = _.over(skypeToken.cracker, jwt.cracker, regToken.cracker, syncState.cracker, base64.cracker);\r\n\r\n    return _.compact(tests(token));\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}